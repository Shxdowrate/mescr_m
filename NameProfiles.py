#‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
# ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
# ‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó mescr modules             
# ‚ñà‚ñà‚ïî‚ñà‚ñà‚ñà‚ñà‚ïî‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë  ‚ïö‚ïê‚ïù‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù not lisensed              
# ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó https://t.me/mescr_m      
# ‚ñà‚ñà‚ïë ‚ïö‚ïê‚ïù ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
# ‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù  
#‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
#‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
# meta developer: @mescr_m 
#‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
#‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
# idea:             
# thanks:                   
#‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
#‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî

from .. import utils, loader
c = loader.command
import datetime
import asyncio
from telethon.tl import functions

__version__ = (1, 0, 0)

class NameProfiles(loader.Module):
    '''–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–º–µ–Ω–∞ –Ω–∏–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏\nDeveloper: @mescr_m'''

    strings = {
        'name': 'NameProfiles',
        'timezone': '–í–∞—à —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å',
        'autostart': '–ó–∞–ø—É—Å–∫–∞—Ç—å –ª–∏ –º–æ–¥—É–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —é–∑–µ—Ä–±–æ—Ç–∞?'
    }

    def __init__(self):
        self.config = loader.ModuleConfig(
            loader.ConfigValue(
                "timezone", 0,
                lambda: self.strings("timezone"),
                validator=loader.validators.Integer()
            ),
            loader.ConfigValue(
                "autostart", False,
                lambda: self.strings("autostart"),
                validator=loader.validators.Boolean()
            ),
        )

    async def client_ready(self):
        self.set('status', False) if self.get('status') == None else None
        self.set('profiles', []) if self.get('profiles') == None else None
        self.set('fact_status', False) if self.get('fact_status') == None else None
        if self.config['autostart'] == True:
            if self.get('status') == True:
                await self.nameprofiles_function()
                return
        else:
            self.set('status', False)
            self.set('fact_status', False)

    @c()
    async def nameprofileadd(self, message):
        '''[ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ {hh:mm} ] [ –ù–∏–∫ ] - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –Ω–∏–∫–∞'''
        args = utils.get_args_raw(message)
        if args:
            if ' ' in args:
                time = args.split(' ')[0]
                nick = ' '.join(args.split(' ')[1:])
                if len(time) == 5 and time.split(':')[0].isdigit() and time.split(':')[1].isdigit() and int(time.split(':')[0]) >= 0 and int(time.split(':')[0]) <= 23 and int(time.split(':')[1]) >= 0 and int(time.split(':')[1]) <= 59:
                    if time not in self.get('profiles'):
                        self.get('profiles').append(time)
                        self.set(time, nick)
                        await utils.answer(message, f'<emoji document_id=5332533929020761310>‚úÖ</emoji> –ü—Ä–æ—Ñ–∏–ª—å "<code>{nick}</code>" —Å–æ–∑–¥–∞–Ω. –û–Ω –±—É–¥–µ—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤ {time}.')
                        return
                    else:
                        await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
                        '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–≠—Ç–æ –≤—Ä–µ–º—è —É–∂–µ –∑–∞–Ω—è—Ç–æ.'
                        '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è –∏–ª–∏ —É–¥–∞–ª–∏—Ç–µ —Ç–µ–∫—É—â–µ–µ, –∞ –ø–æ—Å–ª–µ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.')
                        return
                else:
                    await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
                    '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏.'
                    '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–í–≤–µ–¥–∏—Ç–µ –≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø–µ—Ä–≤–æ–º –∞—Ä–≥—É–º–µ–Ω—Ç–µ. –§–æ—Ä–º–∞—Ç: hh:mm, –ø—Ä–∏–º–µ—Ä: 01:28')
                    return
            else:
                await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
                '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–í—ã —É–∫–∞–∑–∞–ª–∏ —Ç–æ–ª—å–∫–æ 1 –∞—Ä–≥—É–º–µ–Ω—Ç, —Ö–æ—Ç—è –Ω—É–∂–Ω–æ 2.'
                '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–£–∫–∞–∂–∏—Ç–µ 2 –∞—Ä–≥—É–º–µ–Ω—Ç–∞.')
                return
        else:
            await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
            '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–í—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.'
            '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–£–∫–∞–∂–∏—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Å–æ–≥–ª–∞—Å–Ω–æ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º –≤ help.')
            return
        
    @c()
    async def nameprofiledel(self, message):
        '''[ –ø—Ä–æ—Ñ–∏–ª—å(–≤—Ä–µ–º—è) ] - —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è –Ω–∏–∫–∞'''
        args = utils.get_args_raw(message)
        if args:
            if len(args) == 5 and args.split(':')[0].isdigit() and args.split(':')[1].isdigit():
                if args in self.get('profiles'):
                    self.get('profiles').remove(args)
                    self.set(args, None)
                    await utils.answer(message, f'–ü—Ä–æ—Ñ–∏–ª—å –¥–ª—è <code>{args}</code> —É–¥–∞–ª–µ–Ω.')
                    return
                else:
                    await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
                    '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–ü—Ä–æ—Ñ–∏–ª—è –Ω–∞ —ç—Ç–æ –≤—Ä–µ–º—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.'
                    '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª –∑–∞–¥–∞–Ω –ø—Ä–æ—Ñ–∏–ª—å.')
                    return
            else:
                await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
                '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏.'
                '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–í–≤–µ–¥–∏—Ç–µ –≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏. –§–æ—Ä–º–∞—Ç: hh:mm, –ø—Ä–∏–º–µ—Ä: 01:28')
                return
        else:
            await utils.answer(message, f'<emoji document_id=5980953710157632545>üö´</emoji> <b>Error</b> // <code>{message.raw_text}</code>'
            '\n\n<emoji document_id=5818973781707722673>üó£</emoji> <b><u>–°—É—Ç—å –æ—à–∏–±–∫–∏:</u></b>\n–í—ã –Ω–µ —É–∫–∞–∑–∞–ª–∏ –∞—Ä–≥—É–º–µ–Ω—Ç—ã.'
            '\n\n<emoji document_id=5821302890932736039>üó£</emoji> <b><u>–°–ø–æ—Å–æ–±—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:</u></b>\n–£–∫–∞–∂–∏—Ç–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã —Å–æ–≥–ª–∞—Å–Ω–æ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º –≤ help.')
            return
        
    @c()
    async def nameprofiles(self, message):
        '''- –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏'''
        if self.get('profiles'):
            times = self.get('profiles')
            text = f'<emoji document_id=5334882760735598374>üìù</emoji> –í–∞—à–∏ –ø—Ä–æ—Ñ–∏–ª–∏ ({len(self.get("profiles"))}):\n'
            for time in times:
                nick = self.get(time)
                text += f'\n{time} | {nick}'
            await utils.answer(message, text)
            return
        else:
            await utils.answer(message, f'<emoji document_id=5334882760735598374>üìù</emoji> –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–æ—Ñ–∏–ª–µ–π.')
            return

    @c()
    async def nameprofilesreset(self, message):
        '''- —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏'''
        for time in self.get('profiles'):
            self.set(time, None)
        self.set('profiles', [])
        await utils.answer(message, f'<emoji document_id=5332533929020761310>‚úÖ</emoji> –í—Å–µ –ø—Ä–æ—Ñ–∏–ª–∏ —É–¥–∞–ª–µ–Ω—ã.')
        
    @c()
    async def nameprofilesstatus(self, message):
        '''- –≤–∫–ª—é—á–∏—Ç—å / –≤—ã–∫–ª—é—á–∏—Ç—å –º–æ–¥—É–ª—å'''
        if self.get('status') == True:
            self.set('status', False)
            await utils.answer(message, f'<emoji document_id=5332533929020761310>‚úÖ</emoji> NameProfiles –æ—Ç–∫–ª—é—á–µ–Ω.')
            return
        else:
            if self.get('fact_status') == False:
                self.set('status', True)
                await utils.answer(message, f'<emoji document_id=5332533929020761310>‚úÖ</emoji> NameProfiles –∑–∞–ø—É—â–µ–Ω.')
                await self.nameprofiles_function()
                return
            else:
                self.set('status', True)
                await utils.answer(message, f'<emoji document_id=5332533929020761310>‚úÖ</emoji> NameProfiles –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω.')
                return
            
    @c()
    async def nameprofilesguide(self, message):
        '''- –ø–æ–º–æ—â—å –ø–æ –º–æ–¥—É–ª—é'''
        await utils.answer(message, f'<emoji document_id=5452069934089641166>‚ùì</emoji> <b>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å NameProfiles?</b>\n\n–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏–º –ø—Ä–æ—Ñ–∏–ª—å "12:00 MyNick Day", —Ç–µ–ø–µ—Ä—å, –≤ 12:00 –≤–∞—à –Ω–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–º–µ–Ω–∏—Ç—Å—è –Ω–∞ "MyNick Day", –ø—Ä–æ—Ñ–∏–ª–∏ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –Ω–∞ –ª—é–±–æ–µ –≤—Ä–µ–º—è —Å 00:00 –¥–æ 23:59, –¥–æ 1440 –ø—Ä–æ—Ñ–∏–ª–µ–π.')

    async def nameprofiles_function(self):
        while True:
            await asyncio.sleep(0.5)
            if self.get('status') == True:
                self.set('fact_status', True)
                current_time = datetime.datetime.now()
                timezone = self.config['timezone'] 
                new_time = current_time + datetime.timedelta(hours=timezone)
                time = new_time.strftime("%H:%M")
                if self.get(time) != None:
                    await self.client(functions.account.UpdateProfileRequest(first_name=self.get(time)))
                await asyncio.sleep(60)
            else:
                self.set('fact_status', False)
                break