#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
# â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— mescr modules             
# â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘  â•šâ•â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• not lisensed              
# â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•   â•šâ•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•— https://t.me/mescr_m      
# â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# â•šâ•â•     â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•  â•šâ•â•â•â•â• â•šâ•â•  â•šâ•â•  
#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
#â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# meta developer: @mescr_m 
#â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# idea:             
# thanks:                   
#â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

__version__ = (1, 0, 0)

from .. import loader, utils
import random
import re

class UnlimitedRP(loader.Module):
    '''ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸ĞµĞ¹ RolePlay Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¹\nDeveloper: @mescr_m'''

    strings = {
        'name': 'UnlimitedRP',
        'max_words_limit': 'ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ĞºĞ¾Ğ»-Ğ²Ğ¾ ÑĞ»Ğ¾Ğ², Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»',
        'ban_words': 'Ğ•ÑĞ»Ğ¸ ÑÑ‚Ğ¸ ÑĞ»Ğ¾Ğ²Ğ° ĞµÑÑ‚ÑŒ Ğ² Ğ²Ğ°ÑˆĞµĞ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¸, Ñ‚Ğ¾ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¸Ñ…',
        'emojies': 'Ğ­Ğ¼Ğ¾Ğ´Ğ¶Ğ¸, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğµ Ğ¼Ğ¾Ğ³ÑƒÑ‚ Ğ¿Ğ¾ÑĞ²Ğ¸Ñ‚ÑŒÑÑ Ğ² Ğ²Ğ°ÑˆĞµĞ¼ RP Ğ´ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ğ¸',
        'form': 'Ğ¤Ğ¾Ñ€Ğ¼Ğ° RP. ĞšĞ°Ğº Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ñ‹Ğ³Ğ»ÑĞ´ĞµÑ‚ÑŒ Ğ²Ğ°ÑˆĞµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¼.\n{emoji} - ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ ÑĞ¼Ğ¾Ğ´Ğ¶Ğ¸ Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°, {you} - Ğ²Ğ°Ñˆ Ğ½Ğ¸Ğº, {rp} - Ñ‚ĞµĞºÑÑ‚ RP, {user} - Ğ½Ğ¸Ğº Ñ‚Ğ¾Ğ³Ğ¾, Ñ ĞºĞµĞ¼ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµÑ‚Ğµ'
    }

    def __init__(self):
        self.config = loader.ModuleConfig(
            loader.ConfigValue(
                "max_words_limit", 3,
                lambda: self.strings("max_words_limit"),
                validator=loader.validators.Integer()
            ),
            loader.ConfigValue(
                "ban_words", ['**'],
                lambda: self.strings("ban_words"),
                validator=loader.validators.Series()
            ),
            loader.ConfigValue(
                "emojies", ['ğŸ˜€', 'ğŸ˜‚', 'ğŸ˜Š', 'ğŸ¤”', 'ğŸ˜', 'ğŸ™Œ',
                            'ğŸ˜', 'ğŸ¤£', 'ğŸ˜˜', 'ğŸ‘', 'ğŸ‘', 'ğŸ˜‰',
                            'ğŸ˜œ', 'ğŸ¤ª', 'ğŸ˜‡', 'ğŸ¥³', 'ğŸ¤©', 'ğŸ˜›',
                            'ğŸ˜†', 'ğŸ˜', 'ğŸ¥º', 'ğŸ˜¡', 'ğŸ¤¬', 'ğŸ˜­',
                            'ğŸ˜±', 'ğŸ˜´', 'ğŸ¤¯', 'ğŸ¥´', 'ğŸ‘»', 'ğŸ‘½',
                            'ğŸ¤¡', 'ğŸ‘º', 'ğŸ‘¿', 'ğŸ’€', 'ğŸ‘‘', 'ğŸ©',
                            'ğŸ‘š', 'ğŸ§¥', 'ğŸ‘—', 'ğŸ‘ ', 'ğŸ‘‘', 'ğŸ§£',
                            'ğŸ‘¢', 'ğŸ’', 'â›„ï¸', 'ğŸŒ', 'ğŸŒˆ', 'ğŸ‰',
                            'ğŸ•', 'ğŸ”', 'ğŸ¦', 'ğŸ­', 'ğŸ©', 'ğŸ¿',
                            '<emoji document_id=5384232450362719371>âš¡</emoji>'],
                lambda: self.strings("emojies"),
                validator=loader.validators.Series()
            ),
            loader.ConfigValue(
                "form", '{emoji} | <b>{you}</b> {rp} <b>{user}</b>',
                lambda: self.strings("form"),
                validator=loader.validators.String()
            ),
        )

    async def client_ready(self):
        id = self.tg_id
        mm = await self.client.get_messages(-1002031293898, 1)
        if str(id) in mm[0].text:
            raise loader.LoadError('Ğš ÑĞ¾Ğ¶Ğ°Ğ»ĞµĞ½Ğ¸Ñ, Ğ²Ñ‹ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ĞµÑÑŒ Ğ² Ñ‡ĞµÑ€Ğ½Ğ¾Ğ¼ ÑĞ¿Ğ¸ÑĞºĞµ Ğ¼Ğ¾Ğ´ÑƒĞ»ĞµĞ¹ Ğ¾Ñ‚ @mescr_m.\nĞ¡Ğ²ÑĞ¶Ğ¸Ñ‚ĞµÑÑŒ Ğ² Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†ĞµĞ¼ ĞºĞ°Ğ½Ğ°Ğ»Ğ° Ğ´Ğ»Ñ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾Ğ³Ğ¾ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ ÑÑ‚Ğ¾Ğ¹ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹.')
        self.set('status', False) if self.get('status') == None else None

    @loader.watcher(no_commands = True, out = True)
    async def watcher(self, message):
        # ĞŸÑ€ĞµĞ´Ğ²Ğ°Ñ€Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°
        max_word_limit = self.config['max_words_limit']
        ban_words = self.config['ban_words']
        r = await message.get_reply_message()

        # Ğ•ÑĞ»Ğ¸ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ¾: 1
        if self.get('status') == False:
            return

        # Ğ•ÑĞ»Ğ¸ Ğ½ĞµÑ‚ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾ ÑƒÑ‡Ğ°ÑÑ‚Ğ½Ğ¸ĞºĞ° RP: 2
        if not r:
            return

        # ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚ ĞºĞ¾Ğ»-Ğ²Ğ° ÑĞ»Ğ¾Ğ²: 3
        if len(message.raw_text.split(' ')) > max_word_limit:
            return
        
        # ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€ĞµÑ‰ĞµĞ½Ğ½Ñ‹Ñ… ÑĞ»Ğ¾Ğ²: 4
        for word in ban_words:
            if message.raw_text.count(word) > 0:
                return
        
        # ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ RP ÑĞ»Ğ¾Ğ²: 5
        su = ['Ğ°Ñ‚ÑŒ', 'ÑÑ‚ÑŒ', 'ÑƒÑ‚ÑŒ', 'ÑÑ‚ÑŒ', 'Ğ¸Ñ‚ÑŒ', 'Ñ‹Ñ‚ÑŒ', 'ĞµÑ‚ÑŒ']
        words = 0
        for word in message.raw_text.split(' '):
            if len(word) < 4:
                continue
            if word[-3:] not in su:
                continue
            words += 1

        # Ğ•ÑÑ‚ÑŒ Ğ»Ğ¸ RP ÑĞ»Ğ¾Ğ²Ğ°?: 6
        if words == 0:
            return
        
        # Ğ—Ğ°Ğ¼ĞµĞ½Ğ°: 7
        c_words = []
        for word in message.raw_text.split(' '):
            if word[-3:] == 'Ğ°Ñ‚ÑŒ':
                c_words.append(word.replace('Ğ°Ñ‚ÑŒ', 'Ğ°Ğ»'))
            elif word[-3:] == 'ÑÑ‚ÑŒ':
                c_words.append(word.replace('ÑÑ‚ÑŒ', 'ÑĞ»'))
            elif word[-3:] == 'ÑƒÑ‚ÑŒ':
                c_words.append(word.replace('ÑƒÑ‚ÑŒ', 'ÑƒĞ»'))
            elif word[-3:] == 'ÑÑ‚ÑŒ':
                c_words.append(word.replace('ÑÑ‚ÑŒ', 'ÑĞ»'))
            elif word[-3:] == 'Ğ¸Ñ‚ÑŒ':
                c_words.append(word.replace('Ğ¸Ñ‚ÑŒ', 'Ğ¸Ğ»'))
            elif word[-3:] == 'Ñ‹Ñ‚ÑŒ':
                c_words.append(word.replace('Ñ‹Ñ‚ÑŒ', 'Ñ‹Ğ»'))
            elif word[-3:] == 'ĞµÑ‚ÑŒ':
                c_words.append(word.replace('ĞµÑ‚ÑŒ', 'ĞµĞ»'))
            else:
                c_words.append(word)

        # {emoji} - ÑĞ»ÑƒÑ‡Ğ°Ğ¹Ğ½Ñ‹Ğ¹ ÑĞ¼Ğ¾Ğ´Ğ¶Ğ¸ Ğ¸Ğ· ÑĞ¿Ğ¸ÑĞºĞ°, {you} - Ğ²Ğ°Ñˆ Ğ½Ğ¸Ğº, {rp} - Ñ‚ĞµĞºÑÑ‚ RP, {user} - Ğ½Ğ¸Ğº Ñ‚Ğ¾Ğ³Ğ¾, Ñ ĞºĞµĞ¼ Ğ²Ğ·Ğ°Ğ¸Ğ¼Ğ¾Ğ´ĞµĞ¹ÑÑ‚Ğ²ÑƒĞµÑ‚Ğµ

        # Ğ’Ñ‹Ğ²Ğ¾Ğ´: 8
        res = ' '.join(c_words)
        text = self.config['form'].format(emoji = random.choice(self.config['emojies']), you = message.sender.first_name, rp = res, user = r.sender.first_name)
        await message.edit(text)
        return
    
    @loader.command()
    async def unemstatus(self, message):
        '''- Ğ²ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ / Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ'''
        if self.get('status') == False:
            self.set('status', True)
            await utils.answer(message, f'<emoji document_id=5332533929020761310>âœ…</emoji> <b>UnlimitedRP</b> Ğ²ĞºĞ»ÑÑ‡ĞµĞ½.')
            return
        else:
            self.set('status', False)
            await utils.answer(message, f'<emoji document_id=5332533929020761310>âœ…</emoji> <b>UnlimitedRP</b> Ğ¾Ñ‚ĞºĞ»ÑÑ‡ĞµĞ½.')
            return
